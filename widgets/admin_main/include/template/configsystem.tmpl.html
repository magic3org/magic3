/**
 * 表示データ作成用テンプレート(patTemplate)
 *
 * LICENSE: This source file is licensed under the terms of the GNU General Public License.
 *
 * @package    Magic3 Framework
 * @author     平田直毅(Naoki Hirata) <naoki@aplo.co.jp>
 * @copyright  Copyright 2006-2014 Magic3 Project.
 * @license    http://www.gnu.org/copyleft/gpl.html  GPL License
 * @version    SVN: $Id$
 * @link       http://www.magic3.org
 */
<patTemplate:tmpl name="_widget">
<script type="text/javascript">
//<![CDATA[
function updateItem(){
	if (!window.confirm('設定を更新しますか?')) return false;
	document.main.act.value='update';
	document.main.submit();
	return true;
}
function toggleSiteOpen(status){
	if (status == 0){// 停止するとき
		if (!window.confirm('サイト運用を停止しますか?')) return false;
		document.main.act.value='siteclose';
	} else {
		if (!window.confirm('サイト運用を開始しますか?')) return false;
		document.main.act.value='siteopen';
	}
	document.main.submit();
	return true;
}
// プレビューを別ウィンドウで表示
function previewInOtherWindow(type, url)
{
	m3ShowPreviewWindow(type, url);
	return true;
}
$(function(){
	m3SetConfigTable('site_info');
	m3SetConfigTable('system_info');
	m3SetConfigTable('system_version');
	m3SetConfigTable('server_env');
	m3SetConfigTable('db_info');
	m3SetConfigTable('php_info');
});
//]]>
</script>
<div class="m3config_container">
{MENU_ITEMS}
<!-- m3:ErrorMessage -->
<form method="post" name="main">
<input type="hidden" name="task" value="configsys" />
<input type="hidden" name="act" />
<h4>サイトの運用状況</h4>
<table id="site_info">
    <tbody>
    <tr>
	    <th>URL</th>
	    <td colspan="2"><a href="#" onclick="previewInOtherWindow(0, '{SITE_URL}');">{SITE_URL}</a></td>
	</tr>
    <tr>
	    <th>サイト公開</th>
	    <td colspan="2">{SITE_OPEN}<input type="button" class="button" onclick="toggleSiteOpen({SITE_OPEN_STATUS});" value="{SITE_OPEN_LABEL}" />
	    <label>非公開の場合、全アクセスポイントがメンテナンス画面に切り替わります</label></td>
	</tr>
    <tr>
	    <th rowspan="4">アクセスポイント</th>
	    <th>管理用</th><td><a href="#" onclick="previewInOtherWindow(0, '{ADMIN_ACCESS_URL}');">{ADMIN_ACCESS_URL}</a></td>
	</tr>
    <tr>
	    <th>PC用</th><td><patTemplate:tmpl name="show_site_pc_open" visibility="hidden"><input type="checkbox" name="item_site_pc_in_public" {SITE_PC_IN_PUBLIC} />公開<br />
	    <a href="#" onclick="previewInOtherWindow(0, '{PC_ACCESS_URL}');">{PC_ACCESS_URL}</a></patTemplate:tmpl>
		<patTemplate:tmpl name="show_site_pc_close" visibility="hidden">閉鎖</patTemplate:tmpl></td>
	</tr>
    <tr>
	    <th>スマートフォン用</th><td><patTemplate:tmpl name="show_site_smartphone_open" visibility="hidden"><input type="checkbox" name="item_site_smartphone_in_public" {SITE_SMARTPHONE_IN_PUBLIC} />公開<br />
	    <a href="#" onclick="previewInOtherWindow(2, '{SMARTPHONE_ACCESS_URL}');">{SMARTPHONE_ACCESS_URL}</a></patTemplate:tmpl>
		<patTemplate:tmpl name="show_site_smartphone_close" visibility="hidden">閉鎖</patTemplate:tmpl></td>
	</tr>
    <tr>
	    <th>携帯用</th><td><patTemplate:tmpl name="show_site_mobile_open" visibility="hidden"><input type="checkbox" name="item_site_mobile_in_public" {SITE_MOBILE_IN_PUBLIC} />公開&nbsp;&nbsp;画面エンコーディング：{MOBILE_ENCODE}<br />
	    <a href="#" onclick="previewInOtherWindow(1, '{MOBILE_ACCESS_URL}');">{MOBILE_ACCESS_URL}</a></patTemplate:tmpl>
		<patTemplate:tmpl name="show_site_mobile_close" visibility="hidden">閉鎖</patTemplate:tmpl></td>
	</tr>
    </tbody>
</table>
<h4>詳細設定</h4>
<table id="system_info">
    <tbody>
    <tr>
	    <th>システムの<br />ルートURL</th>
	    <td colspan="2">{ROOT_URL}</td>
	</tr>
    <tr>
	    <th><span {_HELP_CONFIGSYS_SSL_URL}>共有SSLの<br />ルートURL</span></th>
	    <td colspan="2"><input type="text" name="item_ssl_url" value="{SSL_URL}" size="60" maxlength="120" style="width:100%;" /></td>
	</tr>
    <tr>
	    <th rowspan="3"><span {_HELP_CONFIGSYS_ACCESS_POINT}>アクセスポイント</span></th>
	    <th><span {_HELP_CONFIGSYS_SITE_PC}>PC用</span></th><td><input type="checkbox" name="item_is_active_site_pc" {IS_ACTIVE_SITE_PC} />有効</td>
	</tr>
    <tr>
	    <th><span {_HELP_CONFIGSYS_SITE_SMARTPHONE}>スマートフォン用</span></th><td><input type="checkbox" name="item_is_active_site_smartphone" {IS_ACTIVE_SITE_SMARTPHONE} />有効&nbsp;&nbsp;マルチドメインURL：<input type="text" name="item_site_smartphone_url" value="{SITE_SMARTPHONE_URL}" size="60" maxlength="120" style="width:100%;" /></td>
	</tr>
    <tr>
	    <th><span {_HELP_CONFIGSYS_SITE_MOBILE}>携帯用</span></th><td><input type="checkbox" name="item_is_active_site_mobile" {IS_ACTIVE_SITE_MOBILE} />有効&nbsp;&nbsp;マルチドメインURL：<input type="text" name="item_site_mobile_url" value="{SITE_MOBILE_URL}" size="60" maxlength="120" style="width:100%;" /></td>
	</tr>
    <tr>
	    <th>ネットワーク</th>
	    <td colspan="2"><label class="item_list_inline"><input type="checkbox" name="item_access_in_intranet" {ACCESS_IN_INTRANET} />イントラネット運用</label></td>
	</tr>
    <tr>
	    <th rowspan="2">URL</th>
	    <td colspan="2"><input type="checkbox" name="item_multi_domain" {MULTI_DOMAIN} />マルチドメイン</td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_use_hier_page" {USE_HIER_PAGE} />ページの階層化</td>
	</tr>
    <tr>
	    <th rowspan="2">SSL</th>
	    <td colspan="2"><input type="checkbox" name="item_use_ssl_admin" {USE_SSL_ADMIN} />管理画面にSSLを使用</td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_use_ssl" {USE_SSL} />一般画面にSSLを使用</td>
	</tr>
    <tr>
	    <th>スマートフォン</th>
	    <td colspan="2"><input type="checkbox" name="item_smartphone_auto_redirect" {SMARTPHONE_AUTO_REDIRECT} />スマートフォンでのアクセスを自動的にスマートフォンURLへ遷移</td>
	</tr>
    <tr>
	    <th rowspan="2">携帯</th>
	    <td colspan="2"><input type="checkbox" name="item_mobile_auto_redirect" {MOBILE_AUTO_REDIRECT} />携帯でのアクセスを自動的に携帯URLへ遷移</td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_mobile_use_session" {MOBILE_USE_SESSION} />携帯でユーザ管理を行う(セッション管理)</td>
	</tr>
    <tr>
	    <th rowspan="4">管理画面</th>
	    <td colspan="2">管理画面用jQueryUIテーマ
	    <select name="item_admin_theme">
	        <patTemplate:tmpl name="admin_theme_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>
	    </td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_can_detail_config" {CAN_DETAIL_CONFIG} />詳細設定モード(開発者向け)</td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_config_window_open_by_tab" {CONFIG_WINDOW_OPEN_BY_TAB} />設定画面をタブで開く</td>
	</tr>
    <tr>
		<td colspan="2">WYSIWYGエディター
	    <select name="item_wysiwyg_editor">
	        <patTemplate:tmpl name="wysiwyg_editor_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>
		</td>
	</tr>
    <tr>
	    <th rowspan="2">一般画面</th>
	    <td colspan="2">jQueryバージョン：
	    <select name="item_jquery_version">
	        <patTemplate:tmpl name="jquery_version_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>&nbsp;&nbsp;
		<input type="checkbox" name="item_use_jquery" {USE_JQUERY} />jQueryを常に使用&nbsp;&nbsp;<input type="checkbox" name="item_smartphone_use_jquery_mobile" {SMARTPHONE_USE_JQUERY_MOBILE} />jQuery Mobileを常に使用(スマートフォン)
		</td>
	</tr>
	<tr>
		<td colspan="2">jQueryUIテーマ
	    <select name="item_default_theme">
	        <patTemplate:tmpl name="theme_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>
		</td>
	</tr>
    <tr>
	    <th rowspan="2">テンプレート</th>
	    <td colspan="2">システム画面テンプレート
	    <select name="item_systemplate">
	        <patTemplate:tmpl name="systemplate_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>
	    </td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_can_change_template" {CAN_CHANGE_TEMPLATE} />一般ユーザによるテンプレートの変更を許可</td>
	</tr>
    <tr>
	    <th rowspan="2">言語</th>
	    <td colspan="2">
	    デフォルト言語
	    <select name="item_lang">
	        <patTemplate:tmpl name="lang_list">
	        <option value="{VALUE}" {SELECTED}>{NAME}</option>
	        </patTemplate:tmpl>
	    </select>
	    </td>
	</tr>
    <tr>
	    <td colspan="2"><input type="checkbox" name="item_multi_language" {MULTI_LANGUAGE} />多言語対応
	    </td>
	</tr>
    <tr>
	    <th>一時ディレクトリ</th>
	    <td colspan="2"><input type="text" name="item_work_dir" value="{WORK_DIR}" size="60" maxlength="120" style="width:70%;" />&nbsp;&nbsp;{WORK_DIR_ACCESS}</td>
	</tr>
        <tr>
	    <th>リソース<br />ディレクトリ</th>
	    <td colspan="2"><div style="text-align:left;float:left;">{RESOURCE_DIR}&nbsp;&nbsp;{RESOURCE_DIR_ACCESS}</div><div style="text-align:right;">ディスク使用量：{RESOURCE_DIR_SIZE}</div></td>
	</tr>
    <tr>
	    <th>テンプレート<br />ディレクトリ</th>
	    <td colspan="2">{TEMPLATES_DIR}&nbsp;&nbsp;{TEMPLATES_DIR_ACCESS}</td>
	</tr>
        <tr>
	    <th>ウィジェット<br />ディレクトリ</th>
	    <td colspan="2">{WIDGETS_DIR}&nbsp;&nbsp;{WIDGETS_DIR_ACCESS}</td>
	</tr>
        <tr>
	    <th>システムDB<br />バージョン</th>
	    <td colspan="2">{SYSTEM_DB_VERSION}&nbsp;&nbsp;更新日時:&nbsp;{SYSTEM_DB_UPDATE_DT}</td>
	</tr>
    </tbody>
</table>
<div class="well m3config_update_buttons"><input type="button" class="button" onclick="updateItem();" value="更新" /></div>
<h4>システムバージョン</h4>
<table id="system_version">
    <tbody>
        <tr>
	    <th style="width:300px;">ディストリビューション名</th>
	    <td>{DISTRIBUTION_NAME}</td>
	</tr>
        <tr>
	    <th>ディストリビューションバージョン</th>
	    <td>{DISTRIBUTION_VERSION}</td>
	</tr>
        <tr>
	    <th>Magic3フレームワーク</th>
	    <td>{MAGIC3_VERSION}</td>
	</tr>
        <tr>
	    <th>OS</th>
	    <td>{OS_VERSION}</td>
	</tr>
        <tr>
	    <th>PHP</th>
	    <td>{PHP_VERSION}</td>
	</tr>
        <tr>
	    <th>{DB_TYPE}</th>
	    <td>{DB_VERSION}</td>
	</tr>
    </tbody>
</table>
<h4>サーバ環境</h4>
<table id="server_env">
    <tbody>
        <tr>
	    <th style="width:300px;">サーバID</th>
	    <td>{SERVER_ID}</td>
	</tr>
        <tr>
	    <th>システムインストール日時</th>
	    <td>{INSTALL_DT}</td>
	</tr>
        <tr>
	    <th>ホスト名</th>
	    <td>{HOST_NAME}</td>
	</tr>
        <tr>
	    <th>ホストIPアドレス</th>
	    <td>{DNS_RESOLV}</td>
	</tr>
    </tbody>
</table>
<h4>DB接続</h4>
<table id="db_info">
    <tbody>
        <tr>
	    <th style="width:300px;">DB種別</th>
	    <td>{DB_TYPE}</td>
	</tr>
        <tr>
	    <th>ホスト名</th>
	    <td>{DB_HOST_NAME}</td>
	</tr>
        <tr>
	    <th>DB名</th>
	    <td>{DB_NAME}</td>
	</tr>
        <tr>
	    <th>接続ユーザ名</th>
	    <td>{DB_USER_NAME}</td>
	</tr>
    </tbody>
</table>
<h4>PHPの設定</h4>
<table id="php_info">
    <tbody>
        <tr>
	    <th width="300">mbstring</th>
	    <td>{CURRENT_MBSTRING}</td>
	</tr>
        <tr>
	    <th>zlib</th>
	    <td>{CURRENT_ZLIB}</td>
	</tr>
        <tr>
	    <th>gd</th>
	    <td>{CURRENT_GD}</td>
	</tr>
        <tr>
	    <th>xml</th>
	    <td>{CURRENT_XML}</td>
	</tr>
        <tr>
	    <th>gettext</th>
	    <td>{CURRENT_GETTEXT}</td>
	</tr>
        <tr>
	    <th>curl</th>
	    <td>{CURRENT_CURL}</td>
	</tr>
        <tr>
	    <th>アップロード可能なファイルのサイズ</th>
	    <th>{UPLOAD_FILESIZE_LIMIT}&nbsp;バイト</th>
	</tr>
        <tr>
	    <td colspan="2" bgcolor="#ffffff">php.iniの関係するパラメータ (memory_limit &gt;= post_max_size &gt;= upload_max_filesize に設定)</td>
	</tr>
        <tr>
	    <th>memory_limit</th>
	    <td>{MEMORY_LIMIT}&nbsp;バイト</td>
	</tr>
        <tr>
	    <th>post_max_size</th>
	    <td>{POST_MAX_SIZE}&nbsp;バイト</td>
	</tr>
        <tr>
	    <th>upload_max_filesize</th>
	    <td>{UPLOAD_MAX_FILESIZE}&nbsp;バイト</td>
	</tr>
        <tr>
	    <th>file_uploads</th>
	    <td>{FILE_UPLOADS}</td>
	</tr>
    </tbody>
</table>
<h4>PHP環境</h4>
<iframe src="{PHPINFO_URL}" width="100%" height="500" frameborder="0">実際の画面</iframe>
</form>
</div>
</patTemplate:tmpl>
