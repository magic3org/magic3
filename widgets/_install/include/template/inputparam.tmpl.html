/**
 * 表示データ作成用テンプレート(patTemplate)
 *
 * LICENSE: This source file is licensed under the terms of the GNU General Public License.
 *
 * @package    Magic3 Framework
 * @author     平田直毅(Naoki Hirata) <naoki@aplo.co.jp>
 * @copyright  Copyright 2006-2013 Magic3 Project.
 * @license    http://www.gnu.org/copyleft/gpl.html  GPL License
 * @version    SVN: $Id$
 * @link       http://www.magic3.org
 */
<patTemplate:tmpl name="_widget">
<script type="text/javascript">
//<![CDATA[
function gonext(){
	if (isInputValueChanged()){
		if (window.confirm('{_LC_MSG_CHANGE_CONFIG}')){
			document.main.act.value = 'save';
			document.main.submit();
			return true;			
		}
	}
	document.main.task.value = 'checkdb';
	document.main.submit();
	return false;
}
function gofore(){
	if (isInputValueChanged()){
		if (window.confirm('{_LC_MSG_CHANGE_CONFIG}')){
			document.main.act.value = 'save';
			document.main.submit();
			return true;			
		}
	}
	document.main.task.value = 'checkenv';
	document.main.submit();
	return false;
}
function createdef(){
	if (!window.confirm('{_LC_MSG_UPDATE_CONFIG}')) return false;
	document.main.act.value = 'save';
	document.main.submit();
	return false;
}
function testdb(){
	document.main.act.value = 'testdb';
	document.main.submit();
	return false;
}
function isInputValueChanged(){
	if (document.main.h_hostname.value != document.main.hostname.value ||
		document.main.h_dbname.value != document.main.dbname.value ||
		document.main.h_dbuser.value != document.main.dbuser.value ||
		document.main.h_password.value != document.main.password.value){
		return true;
	} else {
		return false;
	}
}
//]]>
</script>
<div class="jumbotron">
<h2>{_LC_TITLE_INSTALL}</h2>
<h3>{_LC_LABEL_VERSION} {VERSION}</h3>
</div>
<div class="content">
<form method="post" name="main" role="form" class="form-horizontal">
<input type="hidden" name="lang" value="{LANG}" />
<input type="hidden" name="task" value="inputparam" />
<input type="hidden" name="act" />
<input type="hidden" name="h_hostname" value="{HOSTNAME}" />
<input type="hidden" name="h_dbname" value="{DBNAME}" />
<input type="hidden" name="h_dbuser" value="{DBUSER}" />
<input type="hidden" name="h_password" value="{PASSWORD}" />
<h2>{_LC_TITLE_INPUT_SITE_INFO}</h2>
<!-- m3:ErrorMessage -->
<h3>{_LC_LABEL_SITE_INFO}</h3>
<div class="form-group">
<label for="rooturl" class="col-lg-2 control-label">{_LC_LABEL_ROOT_URL}</label>
<div class="col-lg-6"><input id="rooturl" name="rooturl" type="text" class="form-control textbox-imeoff" size="50" maxlength="100" value="{ROOT_URL}" /></div>
</div>
<h3>{_LC_LABEL_DB_INFO}</h3>
<div class="form-group">
<label class="col-lg-2 control-label">{_LC_LABEL_DB_TYPE}</label>
<div class="col-lg-4">
      <patTemplate:tmpl name="db_mysql" visibility="hidden">
        <label class="radio-inline"><input name="dbtype" type="radio" value="mysql" {CHECKED} />MySQL</label>
      </patTemplate:tmpl>
      <patTemplate:tmpl name="db_pgsql" visibility="hidden">
        <label class="radio-inline"><input name="dbtype" type="radio" value="pgsql" {CHECKED} />PostgreSQL</label>
      </patTemplate:tmpl>
</div>
</div>
<div class="form-group">
<label for="hostname" class="col-lg-2 control-label">{_LC_LABEL_DB_HOSTNAME}</label>
<div class="col-lg-4"><input id="hostname" name="hostname" type="text" class="form-control textbox-imeoff" size="30" maxlength="30" value="{HOSTNAME}" /></div>
</div>
<div class="form-group">
<label for="dbname" class="col-lg-2 control-label">{_LC_LABEL_DB_NAME}</label>
<div class="col-lg-4"><input id="dbname" name="dbname" type="text" class="form-control textbox-imeoff" size="30" maxlength="64" value="{DBNAME}" /></div>
</div>
<div class="form-group">
<label for="dbuser" class="col-lg-2 control-label">{_LC_LABEL_DB_USER}</label>
<div class="col-lg-4"><input id="dbuser" name="dbuser" type="text" class="form-control textbox-imeoff" size="30" maxlength="30" value="{DBUSER}" /></div>
</div>
<div class="form-group">
<label for="password" class="col-lg-2 control-label">{_LC_LABEL_DB_PASSWORD}</label>
<div class="col-lg-4"><input id="password" name="password" type="text" class="form-control textbox-imeoff" size="30" maxlength="64" value="{PASSWORD}" /></div>
</div>
<div class="form-group">
<div class="col-lg-offset-2 col-lg-2"><button class="btn btn-primary" onclick="testdb();">{_LC_LABEL_TEST_CONNECTION}</button></div>
<div class="col-lg-4"><p class="form-control-static">{DB_TEST}</p></div>
</div>

</form>
<p class="bottom_buttons"><button class="btn btn-primary" onclick="gofore();"><i class="glyphicon glyphicon-arrow-left"></i>{_LC_LABEL_GO_BACK}</button>
<button class="btn btn-primary" onclick="createdef();">{_LC_LABEL_UPDATE_CONFIG}</button>
<button class="btn btn-success" onclick="gonext()" {BUTTON_DISABLED}>{_LC_LABEL_GO_NEXT}<i class="glyphicon glyphicon-arrow-right"></i></button></p>
</div>
</patTemplate:tmpl>
